(()=>{"use strict";const e=document.querySelector(".playerboard"),t=document.querySelector(".enemyboard"),o=document.querySelector(".textfield");let r;function s(e){r=e}function n(e){for(let t=0;t<100;t++){const o=document.createElement("div"),s=[Math.floor(t/10),t%10];o.classList.add("box"),o.classList.add(`box${s[0]}${s[1]}`),o.addEventListener("click",(()=>{r(s,!1)})),o.addEventListener("contextmenu",(e=>{e.preventDefault(),r(s,!0)})),e.appendChild(o)}!function(e){const t=e.querySelector(".xcoords"),o=e.querySelector(".ycoords");for(let e=1;e<=10;e++){const r=document.createElement("div");r.classList.add("coord");const s=document.createElement("p");s.textContent=`${e}`,r.appendChild(s),t.appendChild(r);const n=document.createElement("div");n.classList.add("coord");const a=document.createElement("p");a.textContent=String.fromCharCode(64+e),n.appendChild(a),o.appendChild(n)}}(e)}function a([e,t],o,r,s){const n=document.createElement("div"),a=s.querySelector(`.box${e}${t}`);n.classList.add("ship"),n.classList.add(r),o&&n.classList.add("horizontal"),a.appendChild(n)}function i([e,t],o,r){const s=document.createElement("div"),n=r.querySelector(`.box${e}${t}`);s.classList.add(o),n.insertBefore(s,n.children[0])}function c(e){o.innerText=e}const d={patrol:2,submarine:3,destroyer:3,battleship:4,carrier:5};class l{constructor(e){this.type=e,this.length=d[e],this.hits=0,this.hasSunk=!1}hit(){this.hits++}isSunk(){return this.hits>=this.length}}class h{constructor(){this.ships=0}placeShip(e,t,o,r){const s=new l(r);if(o)for(let o=0;o<s.length;o++){if(!(void 0===this[`${e}, ${t+o}`]&&t+o<=9)){for(let r=0;r<o;r++)this[`${e}, ${t+r}`]=void 0;return console.log("ships overlap or overflow")}this[`${e}, ${t+o}`]=s}else for(let o=0;o<s.length;o++){if(!(void 0===this[`${e+o}, ${t}`]&&e+o<=9)){for(let r=0;r<o;r++)this[`${e+r}, ${t}`]=void 0;return console.log("ships overlap or overflow")}this[`${e+o}, ${t}`]=s}return this.ships++,"ok"}receiveAttack([e,t]){return"object"==typeof this[`${e}, ${t}`]?(this[`${e}, ${t}`].hit(),this[`${e}, ${t}`].isSunk()&&this.ships--,this[`${e}, ${t}`]="hit","hit"):this[`${e}, ${t}`]="miss"}shipsLeft(){return this.ships}}class u{constructor(e){this.type=e,this.moves=[]}takeTurn(e=Math.floor(10*Math.random()),t=Math.floor(10*Math.random())){return"computer"===this.type?this.moves.reduce(((o,r)=>r[0]===e&&r[1]===t||o),!1)?this.takeTurn():(this.moves.push([e,t]),[e,t]):"human"===this.type?this.moves.reduce(((o,r)=>r[0]===e&&r[1]===t||o),!1)?console.log("invalid, already played"):(this.moves.push([e,t]),[e,t]):void 0}}const m=new u("human"),p=new u("computer");m.gameBoard=new h,p.gameBoard=new h;let f=!1;const y=["patrol","submarine","destroyer","battleship","carrier"];function $([e,t]){let o="miss",r="miss",n=m.takeTurn(e,t);if("object"==typeof n&&(r=p.gameBoard.receiveAttack(n),i(n,r,document.querySelector(".enemyboard")),0===p.gameBoard.shipsLeft()&&(f=!0,c("You won"),s((()=>0))),"miss"===r)){let e=p.takeTurn();for(o=m.gameBoard.receiveAttack(e),i(e,o,document.querySelector(".playerboard"));"hit"===o;){let t=Math.random()>.5;e=e[0]>0&&e[0]<9&&t?p.takeTurn(e[0]+=Math.random()>.5?-1:1,e[1]):e[1]>0&&e[1]<9&&!t?p.takeTurn(e[0],e[1]+=Math.random()>.5?-1:1):p.takeTurn(),o=m.gameBoard.receiveAttack(e),i(e,o,document.querySelector(".playerboard"))}0===m.gameBoard.shipsLeft()&&(f=!0,c("Enemy won"),s((()=>0)))}}n(e),n(t),function(){for(let e=0;e<5;e++){let t,o,r,s=Math.random()>=.5;do{t=Math.floor(10*Math.random()),o=Math.floor(10*Math.random()),r=p.gameBoard.placeShip(t,o,s,y[e])}while("ok"!==r);a([t,o],s,y[e],document.querySelector(".enemyboard"))}}(),s((function([e,t],o){let r=m.gameBoard.shipsLeft();"ok"===m.gameBoard.placeShip(e,t,o,y[r])&&(a([e,t],o,y[r],document.querySelector(".playerboard")),c(`place ${y[r+1]}`),r>3&&(s($),c("game started")))})),c(`place ${y[0]}, click left for vertical, click right for horizontal`)})();